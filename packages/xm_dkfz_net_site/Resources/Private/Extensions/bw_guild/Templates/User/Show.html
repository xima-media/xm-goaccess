<div class="userprofile" xmlns:f="http://www.w3.org/1999/html">

	<div class="userprofile__header">

		<div class="image">
			<f:render partial="UserImage" arguments="{user: user}"/>
		</div>


		<h1 class="employee-header__title h3">{user.displayName}</h1>

		<div>
			<f:if condition="{user.contactFunction}">
				<p class="m-b-0">{user.contactFunction}</p>
			</f:if>
			<f:if condition="{user.groups}">
				<p class="m-b-0"><strong>
					<f:for each="{user.groups}" as="group" iteration="i">
						{group.title}{f:if(condition: i.isLast, else: ', ')}
					</f:for>
				</strong></p>
			</f:if>
		</div>

		<button type="button"
				class="button button--primary hide-for-self"
				data-user-uid="{user.uid}"
				data-bookmark-url="{f:uri.action(action: 'bookmark', pageUid: '1', controller: 'Api', extensionName: 'BwGuild', pluginName: 'Api', pageType: 1657523819, pageUid: 2, arguments: {tableName: 'fe_users', recordUid: user.uid})}">
			<span data-onload>
				<f:render partial="Icon" arguments="{icon: 'person-add'}"/>
				<f:translate extensionName="XmDkfzNetSite" key="user.bookmark"/>
			</span>
			<span data-checked>
				<f:render partial="Icon" arguments="{icon: 'person-remove'}"/>
				<f:translate extensionName="XmDkfzNetSite" key="user.bookmark.remove"/>
			</span>
		</button>

		<button class="button button--primary show-for-self"
				data-user-uid="{user.uid}"
				data-user-edit-link="{f:uri.action(action: 'userEditForm', controller: 'Api', extensionName: 'BwGuild', pluginName: 'Api', pageType: 1657523819, pageUid: 2)}">
			<f:render partial="Icon" arguments="{icon: 'pencil'}"/>
			<f:translate extensionName="XmDkfzNetSite" key="userEditForm.profileEdit"/>
		</button>

	</div>

	<div class="userprofile__contact">
		<div class="box">
			<h6>
				<f:translate extensionName="XmDkfzNetSite" key="contact"/>
			</h6>
			<ul class="list">
				<f:for each="{user.phoneContacts}" as="contact" iteration="i">
					<li class="contact__item">
						<f:render partial="Icon" arguments="{icon: 'phone'}"/>
						<a href="tel:{contact.cleanNumber}">{contact.number}</a>
					</li>
				</f:for>
				<f:if condition="{user.email}">
					<li class="contact__item">
						<f:render partial="Icon" arguments="{icon: 'mail'}"/>
						<f:link.email email="{user.email}">{user.email}</f:link.email>
					</li>
				</f:if>
			</ul>
		</div>

		<f:if condition="{user.groups}">
			<div class="box box--groups">
				<h5>
					<f:translate extensionName="XmDkfzNetSite" key="contact"/>
					<f:translate extensionName="XmDkfzNetSite" key="contact.fe_group"/>
				</h5>
				<f:for each="{user.groups}" as="group" iteration="i">
					<p class="m-b-0">{group.title}</p>
					<f:if condition="{group.managers}">
						<h6 class="m-b-0">
							<f:translate extensionName="XmDkfzNetSite" key="group.managers"/>
						</h6>
						<f:for each="{group.managers}" as="groupUser">
							<f:render section="GroupUser" arguments="{groupUser: groupUser}"/>
						</f:for>
					</f:if>
					<f:if condition="{group.secretaries}">
						<h6 class="m-b-0">
							<f:translate extensionName="XmDkfzNetSite" key="group.secretaries"/>
						</h6>
						<f:for each="{group.secretaries}" as="groupUser">
							<f:render section="GroupUser" arguments="{groupUser: groupUser}"/>
						</f:for>
					</f:if>
				</f:for>
			</div>
		</f:if>

		<f:if condition="{user.committee}">
			<div class="infobox color-accent--primary infobox--border">
				<div class="infobox--wrapper">
					<h5 class="infobox__title">
						<f:translate extensionName="XmDkfzNetSite" key="user.committee"/>
					</h5>
					<p class="m-b-0">
						<strong>{f:translate(extensionName:'XmDkfzNetSite', key:'user.committee.member_in')}:</strong>
					</p>
					<p>{user.committee.name}</p>
					<f:if condition="{user.committeeResponsibilities}">
						<p class="m-b-0">
							<strong>{f:translate(extensionName:'XmDkfzNetSite',
								key:'user.committee_responsibilities')}:</strong>
						</p>
						<p>{user.committeeResponsibilities->f:format.nl2br()}</p>
					</f:if>
					<f:if condition="{user.committeeRepresentative}">
						<p class="m-b-0"><strong> {f:translate(extensionName:'XmDkfzNetSite',
							key:'user.committee_representative')}:</strong></p>
						<p>
							<f:link.action action="show"
										   pageUid="{settings.showPid}"
										   pluginName="Usershow"
										   controller="User"
										   arguments="{user: user.committeeRepresentative}">
								{user.committeeRepresentative.displayName}
							</f:link.action>
						</p>
					</f:if>
				</div>
			</div>
		</f:if>

	</div>

	<div>
		<div class="userprofile__facts">
			<ul class="list">
				<f:if condition="{user.location}">
					<li>
						<span>
							<f:render partial="Icon" arguments="{icon: 'map'}"/>
						</span>
						<p class="text-small">
							<strong>
								<f:translate extensionName="XmDkfzNetSite" key="user.location"/>
							</strong> {user.location}
						</p>
					</li>
				</f:if>
				<f:if condition="{user.contactRoom}">
					<li>
						<span>
							<f:render partial="Icon" arguments="{icon: 'location'}"/>
						</span>
						<p class="text-small">
							<strong>
								<f:translate extensionName="XmDkfzNetSite" key="place.room"/>
							</strong> {user.contactRoom}
						</p>
					</li>
				</f:if>
				<f:if condition="{user.memberSince}">
					<li>
						<span>
							<f:render partial="Icon" arguments="{icon: 'calendar'}"/>
						</span>
						<p class="text-small">
							<strong>
								<f:translate extensionName="XmDkfzNetSite" key="user.member_since"/>
							</strong> {user.memberSince->f:format.date(format:'d.m.Y')}
						</p>
					</li>
				</f:if>
				<f:if condition="{user.representative}">
					<li>
						<span>
							<f:render partial="Icon" arguments="{icon: 'user-plus'}"/>
						</span>
						<p class="text-small">
							<strong>
								<f:translate extensionName="XmDkfzNetSite" key="user.representative"/>
							</strong>
							<f:link.action action="show" arguments="{user: user.representative}">
								{user.representative.displayName}
							</f:link.action>
						</p>
					</li>
				</f:if>
				<f:if condition="{user.responsibilities}">
					<li>
						<span>
							<f:render partial="Icon" arguments="{icon: 'clipboard'}"/>
						</span>
						<p class="text-small">
							<strong>
								<f:translate extensionName="XmDkfzNetSite" key="user.responsibilities"/>
							</strong> {user.responsibilities}
						</p>
					</li>
				</f:if>
			</ul>
		</div>

		<f:if condition="{user.about}">
			<div class="userprofile__about">
				<h3 class="h4">
					<f:translate extensionName="XmDkfzNetSite" key="user.about"/>
				</h3>
				<p>{user.about->f:format.nl2br()}</p>
			</div>
		</f:if>

		<f:alias map="{items: {0:0,1:1,2:2}}">
			<f:for each="{items}" as="key">
				<f:if condition="{user.featuresGroupedByRecordType.{key}}">
					<div class="userprofile__features">
						<h4 class="h5">
							<f:translate extensionName="XmDkfzNetSite" key="userEditForm.feature-{key}-headline"/>
						</h4>
						<ul class="list list--inline">
							<f:for each="{user.featuresGroupedByRecordType.{key}}" as="feature">
								<span class="button button--secondary" data-feature="{feature.uid}">
									<span>{feature.name}</span>
								</span>
							</f:for>
						</ul>
					</div>
				</f:if>
			</f:for>
		</f:alias>

	</div>

</div>

<f:section name="GroupUser">
	<div class="box__user">
		<f:link.action action="show"
					   pageUid="{settings.showPid}"
					   pluginName="Usershow"
					   controller="User"
					   arguments="{user: groupUser.uid}">
			<f:render partial="UserImage" arguments="{user: groupUser, width: 70}"/>
		</f:link.action>
		<div>
			<f:link.action action="show"
						   pageUid="{settings.showPid}"
						   pluginName="Usershow"
						   controller="User"
						   arguments="{user: groupUser.uid}">
				<p class="m-b-0">{groupUser.displayName}</p>
			</f:link.action>
			<ul class="list contacts">
				<f:for each="{groupUser.phoneContacts}" as="contact" iteration="i">
					<li class="contact__item">
						<f:render partial="Icon" arguments="{icon: 'phone'}"/>
						<a href="tel:{contact.cleanNumber}">{contact.number}</a>
					</li>
				</f:for>
				<f:if condition="{groupUser.email}">
					<li class="contact__item">
						<f:render partial="Icon" arguments="{icon: 'mail'}"/>
						<f:link.email email="{groupUser.email}">{groupUser.email}</f:link.email>
					</li>
				</f:if>
			</ul>
		</div>
	</div>
</f:section>
