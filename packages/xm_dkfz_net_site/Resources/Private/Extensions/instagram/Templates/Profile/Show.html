<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
	  xmlns:instagram="http://typo3.org/ns/In2code/Instagram/ViewHelpers"
	  data-namespace-typo3-fluid="true">

<div class="c-socialwall">

	<h3 class="h5">
		<f:render partial="Icon" arguments="{icon:'instagram-gradient', width: 28, height: 28}"/>
		<span>DKFZ auf Instagram</span>
	</h3>

	<div class="c-socialwall__items">
		<f:for each="{feed.data}" as="image" iteration="iteration">
			<f:if condition="{iteration.cycle} <= 6">
				<f:link.external uri="{image.permalink}"
								 title="View on Instagram"
								 target="_blank"
								 rel="noopener">
					<instagram:isLocalImageExisting id="{image.id}">

						<f:then>
							<picture>
								<source srcset="{f:uri.image(src:'/typo3temp/assets/tx_instagram/{image.id}.jpg', width:'250', height:'250c', fileExtension: 'webp')}"
										type="image/webp">
								<source srcset="{f:uri.image(src:'/typo3temp/assets/tx_instagram/{image.id}.jpg', width:'250', height:'250c', fileExtension: 'jpg')}"
										type="image/jpeg">

								<img src="{f:uri.image(src:'/typo3temp/assets/tx_instagram/{image.id}.jpg', width:'250', height:'250c')}"
									 title="{image.caption -> f:format.crop(maxCharacters: 120, append: ' ...')}"
									 alt="{image.caption -> f:format.crop(maxCharacters: 120, append: ' ...')}"
									 loading="lazy"/>
							</picture>
						</f:then>
						<f:else>
							<f:comment>
								If image is not available on the local machine (for any reasons), load from instagram
								directly
							</f:comment>
							<img src="{f:if(condition: image.thumbnail_url, then: image.thumbnail_url, else: image.media_url)}"
								 title="{image.caption -> f:format.crop(maxCharacters: 120, append: ' ...')}"
								 alt="{image.caption -> f:format.crop(maxCharacters: 120, append: ' ...')}"
								 width="500"
								 height="500"/>
						</f:else>
					</instagram:isLocalImageExisting>

					<div class="overlay">
						<p class="text-small">{image.caption->f:format.crop(maxCharacters: 150)}</p>
						<span>
							<f:render partial="Icon" arguments="{icon: 'arrow-right'}"/>
						</span>
					</div>
				</f:link.external>
			</f:if>
		</f:for>
	</div>
</div>

</html>
